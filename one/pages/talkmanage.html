<div id="aaaaaa">
    <link rel="stylesheet" href="../css/talkmanage.css">
    <link rel="stylesheet" href="../../common.css">
    <link rel="stylesheet" href="../../layui/css/layui.css">
    <div class="talktop">
        <span>访谈管理台</span>
        <button class="addtalk right layui-btn layui-btn-normal" data-method="offset" data-type="auto">+ &nbsp;&nbsp;新建访谈</button>
    </div>

    <table class="layui-table" width=100% id="test" lay-filter="test">
    </table>
    <!-- 分页器 -->
    <div id="page" style="position:absolute;bottom:0px;left:40%;margin-left:-28px;"></div>

    <script src="../../layui/layui.all.js"></script>

    <!-- 访谈状态颜色变化 -->
    <script type="text/html" id="talk">
        {{# if(d.status=="正在访谈"){ }}
        <span style="color:#0EB65C;">{{d.status}}</span> {{# }else{}}
        <span>{{d.status}}</span>{{#}}}
    </script>
    <!-- 访谈操作按钮模板 -->
    <script type="text/html" id="handle">
        <a href="javascript:;" lay-event="talkdetail" class="layui-table-link">
            <img src="../../img/edit.png" alt=""> 设置访谈详情
        </a>
        {{# if(d.status=="正在访谈"){ }}
        <a href="javascript:;" lay-event="endtalk" class="layui-table-link   endtalk hover">结束访谈</a> {{# }else{ }}
        <span class="endtalk" style="color:#999999;">结束访谈</span> {{# }}}
        <a href="javascript:;" lay-event="delete" class="layui-table-link " style="color:#FF5500;">
            <img src="../../img/delete.png" alt=""> 删除
        </a>
    </script>

    <!-- 新建在线访谈弹框 模板 -->
    <div id="addinlinetalk" style="display:none;">
        <div class="title">新建在线访谈</div>
        <div class="line">
            <div class="textleft">*访谈名称</div>
            <div class="left">
                <input type="text" class="talk talkname" placeholder="请输入类别名称">
            </div>
            <div class="clear"></div>
        </div>
        <div class="line">
            <div class="textleft">*访谈时间</div>
            <div class="left">
                <input type="text" class="talk" placeholder="请输入时间" id="starttime">至
                <input type="text" class="talk" placeholder="请输入时间" id="endtime">
            </div>
            <div class="clear"></div>
        </div>
        <div class="line">
            <div class="textleft">*本期嘉宾</div>
            <div class="left guests" style="float:left;width:450px;">
                <div class="html">
                    <div class='left guest'>
                        <span>嘉宾1 &nbsp;&nbsp;</span>
                        <img src="../../img/cancel_02.png" alt="">
                    </div>
                </div>
                <button class='left addguest'>添加嘉宾</button>
                <div class="clear"></div>
            </div>
            <div class="clear"></div>
        </div>
        <div class="line">
            <div class="textleft">主持人</div>
            <div class="left">
                <input type="text" class="talk" placeholder="请输入主持人">
            </div>
            <div class="clear"></div>
        </div>
        <div class="line">
            <div class="textleft">会议简介</div>
            <div class="left">
                <textarea class="talkintro" name="" id="" cols="30" rows="8"></textarea>
            </div>
            <div class="clear"></div>
        </div>
        <div class="line">
            <div class="textleft">*访谈场景</div>
            <div class="left select">
                <input type="radio" id="s1" name="selecttype" class="selecttype color-cb"><label for="s1">在线访谈视频</label>
                <input type="radio" id="s2" name="selecttype" class="selecttype color-cb"><label for="s2">图文实录访谈</label>
            </div>
        </div>
    </div>
    <!-- 新建在线预告 模板 -->
    <div id="addadvance" style="display:none;">
        <div class="title">新建访谈预告</div>
        <div class="line">
            <div class="textleft">*本期嘉宾</div>
            <div class="left guests" style="float:left;width:450px;">
                <div class="html">
                    <div class='left guest'>
                        <span>嘉宾1 &nbsp;&nbsp;</span>
                        <img src="../../img/cancel_02.png" alt="">
                    </div>
                </div>
                <button class='left addguest'>添加嘉宾</button>
                <div class="clear"></div>
            </div>
            <div class="clear"></div>
        </div>
        <div class="line">
            <div class="textleft">主持人</div>
            <div class="left">
                <input type="text" class="talk" placeholder="请输入主持人">
            </div>
            <div class="clear"></div>
        </div>
        <div class="line">
            <div class="textleft">会议简介</div>
            <div class="left">
                <textarea class="talkintro" name="" id="" cols="30" rows="8"></textarea>
            </div>
            <div class="clear"></div>
        </div>
        <div class="line">
            <div class="textleft">*访谈场景</div>
            <div class="left select">
                <!-- <span class="radio-select "></span> -->
                <input type="radio" id="s1" value="视频预告" name="selectadvance" class="selectvideo color-cb">

                <label for="s1">视频预告</label>
                <!-- <span class="radio-select"></span> -->
                <input type="radio" id="s2" value="图文预告" name="selectadvance" class="selectimg color-cb">
                <label for="s2">图文预告</label>
            </div>
            <div class="clear"></div>
        </div>
        <div class="line">
            <div class="textleft"></div>
            <div class="left">
                <img class="upfile upimg" src="../../img/upimg.png" alt="">
                <img class="upfile upvideo" src="../../img/upvideo.png" alt="">
            </div>
        </div>
    </div>
    <!-- 添加嘉宾的弹框 -->
    <div id="addguest" style="display:none;">
        <div class="add-guest">添加嘉宾</div>
        <input type="text" class="guestname" placeholder="嘉宾姓名20字以内">
    </div>
    <!-- 结束访谈的弹框 -->
    <div id="endtalkpopup" class='center' style="display:none;">
        <div class='center'>
            <img src="../../img/warning.png" alt="">
        </div>
        <div class="comfirmdo">是否确认结束当前访谈？</div>
    </div>
    <div id="cannotdel" class='center' style="display:none;">
        <div>
            <img src="../../img/warning.png" alt="">
        </div>
        <div class="comfirmdo">不能删除当前访谈，请确定访谈结束后，才能删除访谈</div>
    </div>
    <div id="candel" class='center' class="comfirmdo" style="display:none;">
        <div>
            <img src="../../img/warning.png" alt="">
        </div>
        <div class="comfirmdo">是否确认删除当前访谈</div>
    </div>
</div>
<!-- 
    `<div class='left guest'>
                        <span>${name}&nbsp;&nbsp;</span>
                        <img src="../../img/cancel_02.png" alt="">
                    </div>`
 -->
<script>
    ;
    ! function() {
        var $ = layui.$;
        // 点击弹出结束访谈弹框
        $(".endtalk").click(function() {
            console.log(123);
            alert(12);
        });
        // 点击添加嘉宾
        $("button.addguest").click(function() {
            layer.open({
                type: 1,
                area: ['480px', '360px'],
                title: ['', "background:#fff;border:0"], //'在线调试',
                content: $("#addguest"),
                shade: [0.8, '#393D49'],
                skin: 'addguest',
                shadeClose: true,
                btnAlign: 'c', //按钮居中显示
                btn: ['确定', '取消'],
                yes: function(index, layero) {
                    var name = $("input.guestname").val();
                    var html = "";
                    $(".html").html($('.html').html() + html);
                    $("input.guestname").val("");
                    layer.close(index);
                }
            });
        });
        // 点击弹出新建访谈弹框
        $(".addtalk").click(function() {
            layer.open({
                type: 1,
                area: ['500px', '250px'],
                title: ['', "background:#fff;border:0"], //'在线调试',
                content: '<div class="addtype">请选择所要新建的类型</div>',
                shade: [0.2, '#393D49'],
                skin: 'addkind',
                shadeClose: true,
                btnAlign: 'c', //按钮居中显示
                btn: ['在线访谈', '在线预告'],
                yes: function(index, layero) {
                    //按钮【按钮一】的回调
                    layer.close(index);
                    layer.open({
                        type: 1,
                        area: ['700px', '600px'],
                        title: ['', "background:#fff;border:0"], //'在线调试',
                        content: $("#addinlinetalk"),
                        shade: [0.2, '#393D49'],
                        skin: 'addkind1',
                        shadeClose: true,
                        btnAlign: 'c', //按钮居中显示
                        btn: ['确定'],
                        yes: function(index, layero) {}
                    });
                },
                btn2: function(index, layero) {
                    layer.open({
                        type: 1,
                        area: ['700px', '600px'],
                        title: ['', "background:#fff;border:0"], //'在线调试',
                        content: $("#addadvance"),
                        shade: [0.2, '#393D49'],
                        skin: 'addkind1',
                        shadeClose: true,
                        btnAlign: 'c', //按钮居中显示
                        btn: ['确定'],
                        yes: function(index, layero) {}
                    });
                    //按钮【按钮二】的回调

                    //return false 开启该代码可禁止点击该按钮关闭
                },
                cancel: function() {
                    //右上角关闭回调

                    //return false 开启该代码可禁止点击该按钮关闭
                },
                end: function() {
                    // 无论是确认还是取消，只要层被销毁了，end都会执行，不携带任何参数。
                }
            });
        });
        // 新建访谈开始与时间
        var laydate = layui.laydate;
        laydate.render({
            elem: '#starttime',
            type: 'datetime'
        });
        laydate.render({
            elem: '#endtime',
            type: 'datetime'
        });
        // 表格
        var table = layui.table;
        table.render({
            elem: '#test',
            skin: 'line',
            url: '../data.json',
            cols: [
                [ //表头
                    {
                        field: 'number',
                        title: '序号',
                        width: 100,
                        unresize: true
                    }, {
                        field: 'name',
                        title: '访谈名称',
                        unresize: true
                    }, {
                        field: 'status',
                        title: '访谈状态',
                        width: 120,
                        templet: '#talk',
                        unresize: true
                    }, {
                        field: 'kind',
                        title: '类型',
                        wdith: 150,
                        unresize: true
                    }, {
                        field: 'as',
                        title: '操作',
                        width: 360,
                        toolbar: '#handle',
                        unresize: true
                    }
                ]
            ],
        });
        // 表格点击事件
        table.on('tool(test)', function(obj) { //注：tool是工具条事件名，test是table原始容器的属性 lay-filter="对应的值"
            var data = obj.data; //获得当前行数据
            var layEvent = obj.event; //获得 lay-event 对应的值（也可以是表头的 event 参数对应的值）
            var tr = obj.tr; //获得当前行 tr 的DOM对象

            if (layEvent === 'endtalk') { //查看
                layer.open({
                    type: 1,
                    area: ['480px', '360px'],
                    title: ['', "background:#fff;border:0"], //'在线调试',
                    content: $("#endtalkpopup"),
                    shade: [0.2, '#393D49'],
                    skin: 'end',
                    shadeClose: true,
                    btnAlign: 'c', //按钮居中显示
                    btn: ['确定', '取消'],
                    yes: function(index, layero) {}
                });
            } else if (layEvent === 'delete') { //删除
                console.log(data);
                if (data.status == "正在访谈") {
                    layer.open({
                        type: 1,
                        area: ['480px', '360px'],
                        title: ['', "background:#fff;border:0"], //'在线调试',
                        content: $("#cannotdel"),
                        shade: [0.2, '#393D49'],
                        skin: 'end',
                        shadeClose: true,
                        btnAlign: 'c', //按钮居中显示
                        btn: [],
                        yes: function(index, layero) {}
                    });
                } else {
                    layer.open({
                        type: 1,
                        area: ['480px', '360px'],
                        title: ['', "background:#fff;border:0"], //'在线调试',
                        content: $("#candel"),
                        shade: [0.2, '#393D49'],
                        skin: 'end',
                        shadeClose: true,
                        btnAlign: 'c', //按钮居中显示
                        btn: ['确定', '取消'],
                        yes: function(index, layero) {}
                    });
                }
            } else if (layEvent === 'talkdetail') { //编辑
                //do something
                window.localStorage.setItem("link", "two");
                parent.location.reload();
                //同步更新缓存对应的值
                // obj.update({
                //     username: '123',
                //     title: 'xxx'
                // });
            }
        });
        // 分页器
        var laypage = layui.laypage;

        //执行一个laypage实例
        laypage.render({
            elem: 'page',
            count: 50,
            prev: "<<上一页",
            next: "下一页>>",
            theme: '#4597E0'
        });

        // 点击切换视频 图片
        $("input[name='selectadvance']").click(function() {
            var val = $("input[name='selectadvance']:checked").val();
            console.log(val);
            if (val == "图文预告") {
                $("img.upimg").show();
                $("img.upvideo").hide();
            } else {
                $("img.upimg").hide();
                $("img.upvideo").show();
            }
        });
    }();
</script>